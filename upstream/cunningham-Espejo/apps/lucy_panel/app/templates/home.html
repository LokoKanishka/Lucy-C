<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lucy Panel</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <div class="scanlines"></div>
  <main class="wrap">
    <header class="topbar">
      <div class="brand">NETWATCH</div>
      <h1 class="title">LUCY FUSION CONTROL</h1>
      <div class="version">v fusion.panel</div>
    </header>

    {% if error %}
      <section class="panel error-block">
        <h2>Error</h2>
        <pre>{{ error }}</pre>
      </section>
    {% endif %}

    <section class="app-grid">
      <aside class="panel sidebar">
        <h2 class="panel-title">Operaciones</h2>

        <div class="block">
          <h3>Puerta de Enlace</h3>
          <p class="muted mono">{{ gateway_url }}</p>
        </div>

        <div class="block">
          <h3>Búsqueda de CID</h3>
          <form method="post" action="/cid_lookup" class="stack">
            <input type="text" name="cid" placeholder="cid_..." required />
            <button type="submit">Abrir CID</button>
          </form>
        </div>

        <div class="block">
          <h3>Botonera Principal</h3>
          <div class="stack">
            <form method="post" action="/ops/smoke"><input type="hidden" name="which" value="both" /><button type="submit">Smoke Completo</button></form>
            <form method="post" action="/ops/smoke"><input type="hidden" name="which" value="webhook_smoke" /><button type="submit">Smoke Webhook</button></form>
            <form method="post" action="/ops/smoke"><input type="hidden" name="which" value="gateway_e2e" /><button type="submit">Smoke Gateway</button></form>
          </div>
        </div>
      </aside>

      <section class="panel main-panel">
        <h2 class="panel-title">Enviar Solicitud</h2>
        <form method="post" action="/send" class="stack">
          <label>Texto
            <textarea name="text" rows="6" required placeholder="Pregúntale algo a Lucy..."></textarea>
          </label>
          <div class="row">
            <label class="field">Tipo
              <input type="text" name="kind" value="text" />
            </label>
            <label class="field">Fuente
              <input type="text" name="source" value="ui_panel" />
            </label>
          </div>
          <button type="submit">Enviar a Gateway</button>
        </form>

        <section class="block">
          <h3>Bandejas</h3>
          <div class="tray-grid">
            <article class="tray">
              <h4>Entrada</h4>
              <ul>{% for row in inbox %}<li><a href="/cid/{{ row.cid }}">{{ row.name }}</a></li>{% else %}<li class="muted">vacío</li>{% endfor %}</ul>
            </article>
            <article class="tray">
              <h4>Salida</h4>
              <ul>{% for row in outbox %}<li><a href="/cid/{{ row.cid }}">{{ row.name }}</a></li>{% else %}<li class="muted">vacío</li>{% endfor %}</ul>
            </article>
            <article class="tray">
              <h4>Deadletter</h4>
              <ul>{% for row in deadletter %}<li><a href="/cid/{{ row.cid }}">{{ row.name }}</a></li>{% else %}<li class="muted">vacío</li>{% endfor %}</ul>
            </article>
          </div>
        </section>
      </section>

      <aside class="panel sidebar right">
        <h2 class="panel-title">Accesos Rápidos</h2>

        <div class="block">
          <h3>Botonera Duplicada</h3>
          <div class="stack">
            <form method="post" action="/ops/smoke"><input type="hidden" name="which" value="both" /><button type="submit">Smoke Completo</button></form>
            <form method="post" action="/ops/smoke"><input type="hidden" name="which" value="webhook_smoke" /><button type="submit">Smoke Webhook</button></form>
            <form method="post" action="/ops/smoke"><input type="hidden" name="which" value="gateway_e2e" /><button type="submit">Smoke Gateway</button></form>
          </div>
        </div>

        <div class="block">
          <h3>Navegación</h3>
          <div class="stack">
            <a class="btn-link" href="/browse/inbox">Explorar Entrada</a>
            <a class="btn-link" href="/browse/outbox">Explorar Salida</a>
            <a class="btn-link" href="/browse/deadletter">Explorar Deadletter</a>
          </div>
        </div>
      </aside>
    </section>
  </main>

  <a class="ghost-shortcut" href="/" title="Ghost Home">
    <svg viewBox="0 0 64 64" aria-hidden="true"><path d="M32 6c-11.6 0-21 8.9-21 19.8V58l9-6 7 6 5-6 5 6 7-6 9 6V25.8C53 14.9 43.6 6 32 6zm-8 24a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm16 0a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>
  </a>
</body>
</html>
